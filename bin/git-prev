#!/bin/bash

set -eu -o pipefail

PARENTS=($(git rev-parse HEAD^@))

case ${#PARENTS[@]}
in
  0)
    echo "Commit has no parents" >&2
    exit 2;;
  1)
    git-canonical --checkout "${PARENTS[0]})";;
  *)
    echo "Commit has multiple parents: " >&2
    git show --oneline --no-patch ${PARENTS[@]} >&2
    exit 1;;
esac
